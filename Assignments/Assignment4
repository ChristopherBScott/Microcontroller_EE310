//-----------------------------
// Title: Assignment4.asm
//-----------------------------
// Purpose: To operate a very basic temperature control system, storing register
//	 values based on a user input as well as a measured value
// Dependencies: NONE
// Compiler: MPLABX IDE v6.20
// Author: Christopher Scott
// OUTPUTS: PORTD1, PORTD2,
// INPUTS: keypad, temperature sensor 
// Versions:
//  	V1.0: 3/1/2024 - First Version
//	V2.0: 3/2/2024 - Updated Version
//	V3.0: 3/3/2024 - Final Version
//-----------------------------

    
;---------------------
; Initialization
;---------------------    
include "C:\Users\robot\OneDrive\Desktop\EE310\Assignment4.X\AssemblyConfig.inc"
#include <xc.inc>

;----------------
; PROGRAM INPUTS
;----------------
#define	refTemp	-20
#define	measuredTemp	60

    
;----------------
; REGISTERS
;----------------
#define	refTempREG 0x20
#define	measuredTempREG	0x21
#define	contREG	0X22

;----------------
; PROGRAM OUTPUTS
;----------------
;#define    refTempInputDecimalREG  0x60 
;#define    measuredTempDecimalREG  0x70 
#define	HEATER    PORTD,2
#define	COOLER    PORTD,1

;---------------------
; Main Program
;---------------------
    PSECT absdata,abs,ovrld        ; Do not change

    ORG	0                ;Reset vector
    GOTO    start
    ORG 0x20
    
start:
    ;STORE VALUES
    MOVLW   0
    MOVWF   TRISD,0
    MOVLW   measuredTemp
    MOVWF   measuredTempREG
    MOVLW   refTemp
    MOVWF   refTempREG
  
    ;CHECK IF MEASURED IS A NEGATIVE VALUE
    CLRF    STATUS
    MOVLW   0X0
    MOVF   measuredTempREG,0
    BN	LED_HOT
    
    ;COMPARE
    MOVLW   refTemp
    CPFSGT  measuredTempREG
    GOTO    next1
    GOTO    LED_COOL
next1:
    CPFSLT  measuredTempREG
    GOTO    next2
    GOTO    LED_HOT
    
    ;AT THIS POINT, THEY MUST BE EQUAL, SO ALL OFF
next2:
    MOVLW   0
    MOVWF   contREG
    BCF	    PORTD,1
    BCF	    PORTD,2
    GOTO    theend
    
    
LED_HOT:	
    MOVLW   2
    MOVWF   contREG
    BCF	    PORTD,1
    BSF	    PORTD,2
    GOTO    theend
    
LED_COOL:
    MOVLW   1
    MOVWF   contREG
    BCF	    PORTD,2
    BSF	    PORTD,1
    GOTO    theend

theend:
    sleep
    
